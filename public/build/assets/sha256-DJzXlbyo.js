import{cm as L,cn as H,co as m,B as C,cp as E,cq as y,cr as U,cs as _,ct as I,cu as D,cv as x,L as F,T as G,a5 as S}from"./app-B_AvmNCb.js";function K(i,t="hex"){const s=w(i),n=L(new Uint8Array(s.length));return s.encode(n),t==="hex"?H(n.bytes):n.bytes}function w(i){return Array.isArray(i)?T(i.map(t=>w(t))):k(i)}function T(i){const t=i.reduce((e,c)=>e+c.length,0),s=A(t);return{length:t<=55?1+t:1+s+t,encode(e){t<=55?e.pushByte(192+t):(e.pushByte(247+s),s===1?e.pushUint8(t):s===2?e.pushUint16(t):s===3?e.pushUint24(t):e.pushUint32(t));for(const{encode:c}of i)c(e)}}}function k(i){const t=typeof i=="string"?m(i):i,s=A(t.length);return{length:t.length===1&&t[0]<128?1:t.length<=55?1+t.length:1+s+t.length,encode(e){t.length===1&&t[0]<128?e.pushBytes(t):t.length<=55?(e.pushByte(128+t.length),e.pushBytes(t)):(e.pushByte(183+s),s===1?e.pushUint8(t.length):s===2?e.pushUint16(t.length):s===3?e.pushUint24(t.length):e.pushUint32(t.length),e.pushBytes(t))}}}function A(i){if(i<2**8)return 1;if(i<2**16)return 2;if(i<2**24)return 3;if(i<2**32)return 4;throw new C("Length is too large.")}function z(i,t,s,n){if(typeof i.setBigUint64=="function")return i.setBigUint64(t,s,n);const e=BigInt(32),c=BigInt(4294967295),h=Number(s>>e&c),o=Number(s&c),r=n?4:0,a=n?0:4;i.setUint32(t+r,h,n),i.setUint32(t+a,o,n)}const M=(i,t,s)=>i&t^~i&s,V=(i,t,s)=>i&t^i&s^t&s;class W extends E{constructor(t,s,n,e){super(),this.blockLen=t,this.outputLen=s,this.padOffset=n,this.isLE=e,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(t),this.view=y(this.buffer)}update(t){U(this);const{view:s,buffer:n,blockLen:e}=this;t=_(t);const c=t.length;for(let h=0;h<c;){const o=Math.min(e-this.pos,c-h);if(o===e){const r=y(t);for(;e<=c-h;h+=e)this.process(r,h);continue}n.set(t.subarray(h,h+o),this.pos),this.pos+=o,h+=o,this.pos===e&&(this.process(s,0),this.pos=0)}return this.length+=t.length,this.roundClean(),this}digestInto(t){U(this),I(t,this),this.finished=!0;const{buffer:s,view:n,blockLen:e,isLE:c}=this;let{pos:h}=this;s[h++]=128,this.buffer.subarray(h).fill(0),this.padOffset>e-h&&(this.process(n,0),h=0);for(let f=h;f<e;f++)s[f]=0;z(n,e-8,BigInt(this.length*8),c),this.process(n,0);const o=y(t),r=this.outputLen;if(r%4)throw new Error("_sha2: outputLen should be aligned to 32bit");const a=r/4,u=this.get();if(a>u.length)throw new Error("_sha2: outputLen bigger than state");for(let f=0;f<a;f++)o.setUint32(4*f,u[f],c)}digest(){const{buffer:t,outputLen:s}=this;this.digestInto(t);const n=t.slice(0,s);return this.destroy(),n}_cloneInto(t){t||(t=new this.constructor),t.set(...this.get());const{blockLen:s,buffer:n,length:e,finished:c,destroyed:h,pos:o}=this;return t.length=e,t.pos=o,t.finished=c,t.destroyed=h,e%s&&t.buffer.set(n),t}}const N=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),l=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),b=new Uint32Array(64);class $ extends W{constructor(){super(64,32,8,!1),this.A=l[0]|0,this.B=l[1]|0,this.C=l[2]|0,this.D=l[3]|0,this.E=l[4]|0,this.F=l[5]|0,this.G=l[6]|0,this.H=l[7]|0}get(){const{A:t,B:s,C:n,D:e,E:c,F:h,G:o,H:r}=this;return[t,s,n,e,c,h,o,r]}set(t,s,n,e,c,h,o,r){this.A=t|0,this.B=s|0,this.C=n|0,this.D=e|0,this.E=c|0,this.F=h|0,this.G=o|0,this.H=r|0}process(t,s){for(let f=0;f<16;f++,s+=4)b[f]=t.getUint32(s,!1);for(let f=16;f<64;f++){const d=b[f-15],g=b[f-2],B=x(d,7)^x(d,18)^d>>>3,p=x(g,17)^x(g,19)^g>>>10;b[f]=p+b[f-7]+B+b[f-16]|0}let{A:n,B:e,C:c,D:h,E:o,F:r,G:a,H:u}=this;for(let f=0;f<64;f++){const d=x(o,6)^x(o,11)^x(o,25),g=u+d+M(o,r,a)+N[f]+b[f]|0,p=(x(n,2)^x(n,13)^x(n,22))+V(n,e,c)|0;u=a,a=r,r=o,o=h+g|0,h=c,c=e,e=n,n=g+p|0}n=n+this.A|0,e=e+this.B|0,c=c+this.C|0,h=h+this.D|0,o=o+this.E|0,r=r+this.F|0,a=a+this.G|0,u=u+this.H|0,this.set(n,e,c,h,o,r,a,u)}roundClean(){b.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}}const j=D(()=>new $);function O(i,t){const s=t||"hex",n=j(F(i,{strict:!1})?G(i):i);return s==="bytes"?n:S(n)}export{O as s,K as t};
